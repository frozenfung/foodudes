<!DOCTYPE html>
<html>
<head>
  <title>foodudes</title>
  <%= stylesheet_link_tag 'application', media: 'all', 'data-turbolinks-track' => true %>
  <script src="//maps.google.com/maps/api/js?v=3.13&amp;sensor=false&amp;libraries=geometry" type="text/javascript"></script>
  <script src='//google-maps-utility-library-v3.googlecode.com/svn/tags/markerclustererplus/2.0.14/src/markerclusterer_packed.js' type='text/javascript'></script>
  <%= javascript_include_tag 'application', 'data-turbolinks-track' => true %>
  <%= csrf_meta_tags %>
</head>
<body>
  <nav>
    <div class='nav_logo'>foodudes</div>
    <% if current_user %>
      <div class='fb_login'><%= link_to '登出', auth_sign_out_path, :method => :delete, :class => 'btn btn-primary' %>
      <%= image_tag 'http://graph.facebook.com/973493649331051/picture' , size: "25x25" %>
      <%= current_user.name %>
      </div>
    <% else %>
      <div class='fb_login'><%= link_to 'facebook登入', "/auth/facebook", :class => 'btn btn-primary' %></div>
    <% end %>
  </nav>
  <%= yield %>
  <div id="map"></div>
  <script type='text/javascript'>
    var mapStyle = [
      {
        "stylers": [
            {
                "visibility": "simplified"
            },
            {
                "saturation": 20
            },
            {
                "weight": 3.2
            },
            {
                "lightness": 25
            }
        ]
      }
    ];
    handler = Gmaps.build('Google');
    handler.buildMap({ provider: {
      zoom:      17,
      center:    new google.maps.LatLng(25.026, 121.523),
      mapTypeId: google.maps.MapTypeId.ROADMAP,
      styles:    mapStyle
    }, internal: {id: 'map'}}, function(){
      markers = handler.addMarkers([
        {
          "lat": 0,
          "lng": 0,
          "picture": {
            "url": "https://addons.cdn.mozilla.net/img/uploads/addon_icons/13/13028-64.png",
            "width": 36,
            "height": 36
          },
          "infowindow": "hello!"
        }
      ]);
      handler.bounds.extendWith(markers);
      // handler.fitMapToBounds();
    });
  </script>
</body>
</html>
